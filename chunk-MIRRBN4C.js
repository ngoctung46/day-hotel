import{c as O,d as P,h as M}from"./chunk-HODHY5GA.js";import{a as Z}from"./chunk-JWGCYNZ2.js";import{h as z,i as Y}from"./chunk-4YUIU3BO.js";import{a as E}from"./chunk-FVP4ZNBQ.js";import{a as V,b as g}from"./chunk-4RXUG7LP.js";import{a as k,b as B,d as G,f as v,g as j,h as H,i as q,l as U,m as K,n as Q,o as J,s as W,u as X}from"./chunk-QZCFPOZ3.js";import{F as T,Fb as A,Ga as s,J as x,La as b,Qa as y,Va as h,Y as L,ab as u,c as f,ca as a,db as N,hc as w,ib as t,jb as e,kb as n,mc as S,pa as R,pb as C,q as _,yb as c}from"./chunk-N2SH4PON.js";var p=class m extends B{constructor(){super("customers")}getCustomerByIdNumber(o){return f(this,null,function*(){return(yield this.getItems()).find(r=>r.idNumber===o)??void 0})}static \u0275fac=function(i){return new(i||m)};static \u0275prov=L({token:m,factory:m.\u0275fac,providedIn:"root"})};var oe=()=>["/"];function ie(m,o){m&1&&(t(0,"div",7),n(1,"i",27),e())}function ne(m,o){m&1&&(t(0,"div",28)(1,"b"),c(2,"B\u1EAFt bu\u1ED9c"),e()())}function me(m,o){m&1&&(t(0,"div",7),n(1,"i",27),e())}function se(m,o){m&1&&(t(0,"div",28)(1,"b"),c(2,"B\u1EAFt bu\u1ED9c"),e()())}var I=class m{constructor(o){this.fb=o;this.inintForm(),this.customerService.getItemById(this.customerId).then(i=>this.customer=i)}submittedCustomer=new R;roomId="";customerId="";customer;room;orderId="";customerForm=new q({});customerService=a(p);orderService=a(g);orderLineService=a(E);ngOnInit(){this.customerService.getItemById(this.customerId).then(o=>{this.customer=o,this.initData()})}search=o=>o.pipe(T(200),x(),_(i=>i.length<2?[]:k.filter(r=>r.toLowerCase().indexOf(i.toLowerCase())>-1).slice(0,10)));onSubmit(){this.customer=this.customerForm.value,this.submittedCustomer.emit(this.customer)}onClear(){this.customerForm.reset()}inintForm(){this.customerForm=this.fb.group({name:["",v.required],idNumber:["",v.required],issuedPlace:["C\u1EE5c C\u1EA3nh s\xE1t"],issuedDate:[""],birthDate:[""],birthPlace:[""],nationality:["Vi\u1EC7t Nam"],addressLine1:[""],addressLine2:[""],city:[""],country:["Vi\u1EC7t Nam"],phone:[""]})}initData(){this.customerForm=this.fb.group({name:[this.customer?.name,v.required],idNumber:[this.customer?.idNumber,v.required],issuedPlace:[this.customer?.issuedPlace??"C\u1EE5c C\u1EA3nh s\xE1t"],issuedDate:[this.customer?.issuedDate],birthDate:[this.customer?.birthDate],birthPlace:[this.customer?.birthPlace],nationality:[this.customer?.nationality??"Vi\u1EC7t Nam"],addressLine1:[this.customer?.addressLine1],addressLine2:[this.customer?.addressLine2],city:[this.customer?.city],country:[this.customer?.country??"Vi\u1EC7t Nam"],phone:[this.customer?.phone]}),this.customer!=null&&this.customerForm.disable()}static \u0275fac=function(i){return new(i||m)(b(W))};static \u0275cmp=y({type:m,selectors:[["customer-form"]],inputs:{roomId:"roomId",customerId:"customerId"},outputs:{submittedCustomer:"submittedCustomer"},decls:50,vars:12,consts:[[1,"text-center","text-success"],[3,"ngSubmit","formGroup"],[1,"my-1","mr-2","text-primary"],[1,"row","row-cols-auto","g-1"],[1,"col"],[1,"input-group"],["id","idNumber","type","text","placeholder","CCCD s\u1ED1","formControlName","idNumber","autofocus","",1,"form-control"],[1,"input-group-text","text-success"],["class","form-text text-danger",4,"ngIf"],["type","datetime","placeholder","Ng\xE0y C\u1EA5p","formControlName","issuedDate",1,"form-control"],["type","text","placeholder","N\u01A1i c\u1EA5p","formControlName","issuedPlace",1,"form-control",3,"ngbTypeahead"],[1,"my-1","mr-2","text-info"],[1,"col-3"],["id","lastName","type","text","placeholder","H\u1ECD v\xE0 T\xEAn","formControlName","name",1,"form-control"],["type","text","placeholder","Ng\xE0y Sinh","formControlName","birthDate",1,"form-control"],["type","text","placeholder","N\u01A1i Sinh","formControlName","birthPlace",1,"form-control",3,"ngbTypeahead"],["type","text","placeholder","Qu\u1ED1c T\u1ECBch","formControlName","nationality",1,"form-control"],[1,"my-1","mr-2","text-success"],["type","text","placeholder","S\u1ED1 nh\xE0, \u0111\u01B0\u1EDDng","formControlName","addressLine1",1,"form-control"],["type","text","placeholder","X\xE3, Huy\u1EC7n","formControlName","addressLine2",1,"form-control"],["type","text","placeholder","T\u1EC9nh","formControlName","city",1,"form-control",3,"ngbTypeahead"],["type","text","placeholder","Qu\u1ED1c Gia","formControlName","country",1,"form-control"],["type","number","placeholder","S\u1ED1 \u0110T","formControlName","phone",1,"form-control"],[1,"d-flex","justify-content-center"],["type","button","type","submit","aria-label","Submit customer information",1,"btn","btn-outline-primary","btn-lg","mx-1","bi","bi-floppy",3,"disabled"],["type","button","aria-label","Clear form",1,"btn","btn-outline-info","btn-lg","mx-0","bi","bi-arrow-repeat",3,"click","disabled"],["type","button","aria-label","Clear form",1,"btn","btn-outline-danger","btn-lg","mx-1","bi","bi-x-lg",3,"routerLink"],[1,"bi","bi-check-lg"],[1,"form-text","text-danger"]],template:function(i,r){if(i&1&&(t(0,"h1",0),c(1,"TH\xD4NG TIN KH\xC1CH L\u01AFU TR\xDA"),e(),t(2,"form",1),C("ngSubmit",function(){return r.onSubmit()}),t(3,"label",2)(4,"h4"),c(5,"Gi\u1EA5y t\u1EDD t\xF9y th\xE2n"),e()(),t(6,"div",3)(7,"div",4)(8,"div",5),n(9,"input",6),h(10,ie,2,0,"div",7),e(),h(11,ne,3,0,"div",8),e(),t(12,"div",4),n(13,"input",9),e(),t(14,"div",4),n(15,"input",10),e()(),t(16,"label",11)(17,"h4"),c(18,"Th\xF4ng tin c\xE1 nh\xE2n"),e()(),t(19,"div",3)(20,"div",12)(21,"div",5),n(22,"input",13),h(23,me,2,0,"div",7),e(),h(24,se,3,0,"div",8),e(),t(25,"div",4),n(26,"input",14),e(),t(27,"div",4),n(28,"input",15),e(),t(29,"div",4),n(30,"input",16),e()(),t(31,"label",17)(32,"h4"),c(33,"Th\xF4ng tin li\xEAn h\u1EC7"),e()(),t(34,"div",3)(35,"div",4),n(36,"input",18),e(),t(37,"div",4),n(38,"input",19),e(),t(39,"div",4),n(40,"input",20),e(),t(41,"div",4),n(42,"input",21),e(),t(43,"div",4),n(44,"input",22),e()(),n(45,"br"),t(46,"div",23),n(47,"button",24),t(48,"button",25),C("click",function(){return r.onClear()}),e(),n(49,"button",26),e()()),i&2){let d,l,F,D;s(2),u("formGroup",r.customerForm),s(8),N((d=r.customerForm.get("idNumber"))!=null&&d.valid?10:-1),s(),u("ngIf",(l=r.customerForm.get("idNumber"))==null?null:l.invalid),s(4),u("ngbTypeahead",r.search),s(8),N((F=r.customerForm.get("name"))!=null&&F.valid?23:-1),s(),u("ngIf",(D=r.customerForm.get("name"))==null?null:D.invalid),s(4),u("ngbTypeahead",r.search),s(12),u("ngbTypeahead",r.search),s(7),u("disabled",!r.customerForm.valid||r.customerForm.disabled),s(),u("disabled",r.customerForm.disabled),s(),u("routerLink",A(11,oe))}},dependencies:[Y,z,X,U,G,K,j,H,Q,J,S,w,M,P],encapsulation:2})};var ee=class m{constructor(o){this.router=o}roomService=a(V);customerService=a(p);orderLineService=a(E);orderService=a(g);productService=a(Z);rId="";cId="";set roomId(o){this.rId=o}set id(o){this.cId=o}ngOnInit(){}saveCustomerAsync(o){return f(this,null,function*(){let i=this.customerService.createDoc(),r=this.orderLineService.createDoc(),d=this.orderService.createDoc();this.productService.getHourlyRate().then(l=>f(this,null,function*(){yield this.orderLineService.addItem({orderId:d.id,productId:l?.id,quantity:1,product:l,total:1*l?.price},r)})),yield this.orderService.addItem({customerId:i.id,roomId:this.rId,checkInTime:Date.now(),orderLineIds:[r.id]},d),yield this.customerService.addItem(o,i),this.roomService.updateItem({id:this.rId,customerId:i.id,orderId:d.id,status:1}).then(()=>{this.router.navigate(["/home"])})})}static \u0275fac=function(i){return new(i||m)(b(O))};static \u0275cmp=y({type:m,selectors:[["app-customer"]],inputs:{roomId:"roomId",id:"id"},decls:2,vars:2,consts:[[1,"container"],[3,"submittedCustomer","roomId","customerId"]],template:function(i,r){i&1&&(t(0,"div",0)(1,"customer-form",1),C("submittedCustomer",function(l){return r.saveCustomerAsync(l)}),e()()),i&2&&(s(),u("roomId",r.rId)("customerId",r.cId))},dependencies:[I,S],encapsulation:2})};export{ee as CustomerComponent};
